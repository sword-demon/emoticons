# 表情包网站

## 核心需求

输入表情包主题描述，16 个关键词描述，调用豆包 API 或者即梦 AI 根据描述生成一套表情包图，利用前端技术合成微信表情包需要的图片尺寸，并且将字体对应在图片里面展示，此外需要注意以下细节：

1. 表情包需要水印展示
2. 输入描述需要给文案指引，引导用户书写稳定的关键词
3. 表情包的尺寸需要跟微信表情包平台的尺寸保持一致，这里有多个尺寸，下载时需要打包成压缩包个诶到用户，展示时候选择一个合适尺寸展示即可（或者可以后续支持切换多个尺寸给用户看）

## 技术栈 & 相关 API 文档

- 即梦 AI 图像生成接入文档：https://www.volcengine.com/docs/85621/1537648#ie5aupr9
- 即梦 AI 主要用于鉴权，详见 公共参数-签名参数-在 Header 中的场景部分：https://www.volcengine.com/docs/6369/67268

> 使用 context7 搜索对应的文档

## 核心功能需求

### 一、表情包生成与预览

在设计输入界面，我们需要 **降低门槛，消除用户的‘白屏恐惧症’**，因此“清晰的文案指引”和“示例”是必须的。比如，我不会只写“请输入描述”，而是会引导性地写“例如： 一只戴着眼镜的黄色柴犬”，给用户一个具体的起点。

#### UI 布局

页面顶部或侧边提供清晰的输入区域，包含两个主要的文本输入框

表情包主体描述

- 描述：用户描述表情包主角以及其主要特征
- 字数限制：建议<= 50 字
- 占位符/提示：”例如：简单背景，穿着黑色短袖的男人“
- 描述指引： ”请尽可能具体地描述表情包主角的及其主要特征，例如‘一只戴着眼镜的黄色柴犬’，这将影响 AI 生成的基础形象“

16 个关键词描述

- 描述：用户输入与表情包情感或动作相关的关键词，将对应生成 16 张表情
- 数量：强制要求 16 个关键词
- 字数限制：每个关键词建议<=5 字
- 输入方式：考虑提供多行文本输入框，或 16 个独立的输入框，方便用户填写
- 占位符/提示：”例如：开心大小，思考人生，震惊，委屈，加油，疑问。。。“(可提供逗号分隔的示例)
- 文案指引：在每个输入框下方或旁边，提供清晰的文案指引和示例，引导用户书写文档、具体、有利于 AI 理解的关键词和描述
- 描述指引：”请填写与表情包情感或动作相关的词语，例如‘开心大笑’、‘思考人生’、‘震惊的说不出话’。请避免使用过于抽象或复杂的词语，确保每个词语都能清晰表达一种情绪或动作。“

### 二、预设关键词与灵感词库

微信表情包的表情专辑，支持上传 8-24 张，我们一般都推荐做 16 张甚至 24 张。结果会发现，要想凭空想出十几个、二十几个又好玩又有梗的关键词，简直是”要命“的挑战！

1. 使用 AI 当灵感策划
   利用这一点让 AI 扮演一个”网感十级的创意总监“，帮我干两件事

   - 批量生产”表情包主角“：直接让 AI 给我来一百个稀奇古怪、自带反差萌的主角描述，并且分类。
   - 准备关键词素材库：让 AI 把网上最火的梗、最常用的聊天场景用到的关键词纳进素材库，将这些词喂给 AI ，让对方转换为`json`最为静态资源库，这样子网站直接调用

2. 灵感喂到嘴边
   有了 AI 给的”弹药库“，接下来就是在界面上把它用起来，而且这必须得做得够简单，够傻瓜。

   - 主角输入框旁边：我们放一个”换个灵感“的按钮。用户点一下，框里就换个新奇的主角，就跟开盲盒一样，好玩！
   - 关键词输入框旁边：我们加个”填充主题关键词“的按钮。一点开，各种”套餐“任君选择。看中了”职场吐槽“？再一点，十几个吐槽词儿”唰“地一下就全填进去了。用户自己还能再改改，简直不要太爽。

3. AI 模型调用

- 安全：绝对不能在前端直接调用 AI 的 API
  > 需要把所有的 AI 调用逻辑都封装在 Next.js 的后端 API 路由里。这样，用户在浏览器端的所有操作，都不会触及宝贵的 API KEY，安全第一！
- 反馈：点击按钮没有任何反馈是最糟糕的体验

  > 如果用户点击按钮后，页面半天没有反应，他可能会以为卡主了然后关闭网页。所以，一个明确的加载中的状态是必不可少的，这能极大地安抚用户的情绪，提升整体体验。同时，如果报错了打印在后台，那么我们就能第一时间知道哪个环节出现了卡点。

根据以上需求优化的后的细则如下：

- 触发方式: 前端提供一个“生成表情包”按钮。前端通过 `Axios` 向 `Next.js` 的自定义 API Route(`/api/generate-emojis`)发送 POST 请求，传递主体描述和 16 个关键词。
- 在 API Route (Node.js 环境) 中:导入并使用**即梦 AI 官方 Node.js SDK**。安全地从环境变量中读取即梦 A! 的 API Key。根据前端传入的描述和关键词，调用即梦 AI SDK 的相应方法生成 16 张表情包图片数据(通常是 Base64 编码或图片 URL)
- 错误处理: 捕获即梦 AI API 调用可能发生的错误，并向前端返回友好的错误信息(例如:AI 生成失败、API 调用限制等)
- 加载状态: 在前端发送 API 请求期间，禁用生成按钮，并显示加载动画或进度条，告知用户当前状态。

4. 图片生成与预览展示

- 前端图片处理: 接收 API Route 返回的图片数据。利用 `canvas API` 或其他前端图片处理库，对每张图片进行以下处理:
- 尺寸合成: 将 AI 生成的图片调整或裁剪为符合微信表情包平台要求的特定尺寸
- 文字添加: 将用户输入的**关键词**(或根据关键词生成的对应文字)作为文字内容，叠加到对应的表情包图片
- 字体样式: 字体需要清晰可辨，并与表情包风格协调(可选择一个默认字体，或预设几种字体供后续选择)
- 字体颜色: 考虑与图片背景形成对比，保证可见性字体颜色:
- 文字位置: 文字需放置在图片底部中央或合适位置，避免遮挡表情主体。

**智能调整(未来优化)**: 理想情况下，文字位置和大小能根据图片内容进行智能调整水印展示

- 在每张生成的表情包图片上添加透明水印，
- 水印内容: 可预设为“AI 生成”或“本站出品”等文字或小 Logo。
- 水印样式: 字体、颜色、大小、透明度需适中，不影响表情包的正常使用和美观。
- 水印位置:可放置在图片角落(例如右下角)，确保不干扰主体。

**预览区**: 在页面上展示 16 张经过处理后的表情包图片，每张图片下方显示对应的关键词。

## 表情包下载

必须包含主图、缩略图、图标等多种尺寸，并自动打包成 ZIP 包，这是为了让用户实现下载即可上传的无缝体验，直接解决了用户手动处理格式的痛点，跳过了 PS 处理图片的环节。

- **下载按钮**：提供一个”下载表情包 ZIP“按钮，位置醒目
- **打包下载**：点击按钮后，前端利用`JSZip`库，将所有 16 张表情包图片，按照微信表情包平台要求的多个尺寸进行打包

**微信表情包尺寸要求**：

主图

- 尺寸：`240x240px`
- 文件名：`01.png`，`02.png`...`16.png`
- 处理逻辑：直接使用 AI 生成图，并在此基础上叠加文字和水印

缩略图

- 尺寸：`120x120px`
- 文件名：`01-thumb.png`,`02-thumb.png`...`16-thumb.png`
- 处理逻辑：将`240x240px`的主图**等比例**缩放到`120x120px`，并进行**锐化**处理以保持清晰度

聊天页图标

- 尺寸: `50x50px`
- 文件名: `01-icon.png`,`02-icon.png`…、`16-icon.png`
- 处理逻辑: 将`240x240px`的主图进行**中心裁剪**到`50x50px`，并添加边框(边框样式和颜色待定，可考虑色或与表情包风格一致的颜色)

详情页横幅

- 尺寸: `750x400px`
- 文件名: `banner.png`
- 处理逻辑: 将前 3 张主图(`01.png`，`02.png`，`03.png`)进行**拼接**，并在其上方或下方叠加文字标题(文字
  内容可由用户输入，或预设为“AI 生成表情包”等)。拼接方式可考虑横向拼接。
- 图片格式: 所有图片需为 PNG 格式，带透明背景。
- 文件命名: 压缩包内的图片文件应严格按规范命名，并按类型进行清晰的文件夹分类，方便用户上传。例如,压缩包内可包含 main/(主图)，thumb/(缩略图)，icon/(图标)，banner/ (横幅) 等文件夹。

下载流程: 触发浏览器下载，将生成的 ZIP 文件保存到用户本地。
